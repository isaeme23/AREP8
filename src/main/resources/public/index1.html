<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Twitter</title>
</head>
<body>
<h1>Hola! Escribe tu tweet </h1>
<form>
  <label for="content">Contenido:</label><br>
  <input type="text" id="content" name="content"><br><br>
  <input type="button" value="Submit" onclick="loadPostMsg()">
</form>

<div id="getrespmsg"></div>

<script>
  function loadPostMsg() {
      let content = document.getElementById('content').value;
      let url = "/twitter/addPost";

      fetch(url, {
          method: 'POST',
          body: JSON.stringify({ content: content }),
          headers: {
              'Accept': 'application/json',
              'Content-Type': 'application/json'
          }
      })
      .then(response => {
          if (!response.ok) {
              throw new Error('Error en la solicitud');
          }
          return response.json();
      })
      .then(data => {
          const container = document.getElementById('getrespmsg');
          console.log('Datos recibidos:', data);
          const keys = Object.keys(data);
          const lastKey = keys[keys.length - 1];
          console.log(data[lastKey]);
          const p = document.createElement('p');
          p.textContent = lastKey;
          container.appendChild(p);
          const h3 = document.createElement('h3');
          var textt = data[lastKey].replace(/[""]/g, "");
          var textt1 = textt.replace("}", "");
          h3.textContent = textt1;
          container.appendChild(h3);
      })
      .catch(error => {
          console.error('Error:', error);
          const container = document.getElementById('getrespmsg');
          container.textContent = 'Error al procesar la solicitud';
      });
  }
</script>
</body>
</html>
